# ğŸ“š ã‚¿ã‚¹ã‚¯åˆ¥ å­¦ç¿’è¨ˆç”» â€” Streak Buddy ã‚’ä½œã‚ŠãªãŒã‚‰å­¦ã¶

> **æ–¹é‡**: åº§å­¦ã‚ˆã‚Šæ‰‹ã‚’å‹•ã‹ã™ã“ã¨ã‚’å„ªå…ˆã€‚å„ã‚¿ã‚¹ã‚¯ã¯ã€Œã“ã‚Œã‚’ä½œã‚‹ â†’ ã“ã†ãªã‚‹ã€ãŒæ˜ç¢ºã€‚
> **ç›®æ¨™**: Streak Buddy (ã‚¹ãƒˆãƒªãƒ¼ã‚¯ç¶™ç¶š Ã— ãƒãƒ¼ãƒãƒ£ãƒ«ãƒšãƒƒãƒˆè‚²æˆ App) ã‚’3ãƒ¶æœˆã§å…¬é–‹ã™ã‚‹ã€‚

---

## ğŸ“¦ ãƒªãƒã‚¸ãƒˆãƒªã®å½¹å‰²åˆ†æ‹…

| ãƒªãƒã‚¸ãƒˆãƒª | å†…å®¹ |
|---|---|
| `platypuscode-portfolio` | ã“ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚µã‚¤ãƒˆã€‚Streak Buddyã¸ã®ãƒªãƒ³ã‚¯ã‚‚æ²è¼‰ã™ã‚‹ |
| `streak-buddy` | ãƒ¡ã‚¤ãƒ³ã®ãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ã‚¢ãƒ—ãƒªã€‚ãƒ•ã‚§ãƒ¼ã‚º1é€±2ã‹ã‚‰ä½œã‚Šå§‹ã‚ã‚‹ |

> **Streak Buddy ãƒªãƒã‚¸ãƒˆãƒªã®ä½œæˆ**: ãƒ•ã‚§ãƒ¼ã‚º1 Week2 ã®Task 5 ã§ `streak-buddy` ã¨ã„ã†åå‰ã§ä½œæˆã™ã‚‹ã€‚
> ãã®ãƒªãƒã‚¸ãƒˆãƒªã«ã€ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ `docs/learning-plan.md` ã¨ã—ã¦ã‚³ãƒ”ãƒ¼ã—ã¦ç¶™ç¶šã—ã¦ä½¿ã†ã“ã¨ã€‚

---

## å…¨ã‚¿ã‚¹ã‚¯ä¸€è¦§

| # | ã‚¿ã‚¹ã‚¯ | ğŸ“¦ ãƒªãƒã‚¸ãƒˆãƒª | ãƒ•ã‚§ãƒ¼ã‚º | çŠ¶æ…‹ |
|---|---|---|---|---|
| 1 | ã“ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚’Vercelã«ãƒ‡ãƒ—ãƒ­ã‚¤ | portfolio | Phase 1 Week 1 | â¬œ |
| 2 | CLAUDE.md ã‚’ä½œæˆã™ã‚‹ | portfolio | Phase 1 Week 1 | â¬œ |
| 3 | TypeScriptã§Streak Buddyã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’å®šç¾©ã™ã‚‹ | portfolio | Phase 1 Week 1 | â¬œ |
| 4 | useLocalStorage ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’ä½œã‚‹ | portfolio | Phase 1 Week 1 | â¬œ |
| 5 | Streak Buddy ãƒªãƒã‚¸ãƒˆãƒªã‚’åˆæœŸåŒ–ã™ã‚‹ | streak-buddy | Phase 1 Week 2 | â¬œ |
| 6 | GitHub APIã§fetchç·´ç¿’ã‚’ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã«è¿½åŠ ã™ã‚‹ | portfolio | Phase 1 Week 2 | â¬œ |
| 7 | Express + TypeScript APIã‚µãƒ¼ãƒãƒ¼ã‚’ç«‹ã¡ä¸Šã’ã‚‹ | streak-buddy | Phase 2 Week 3 | â¬œ |
| 8 | Prisma + SQLite ã§DBã«ç¹‹ã | streak-buddy | Phase 2 Week 3 | â¬œ |
| 9 | ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ãƒ»ãƒ­ã‚°ã‚¤ãƒ³APIã‚’å®Ÿè£…ã™ã‚‹ | streak-buddy | Phase 2 Week 4 | â¬œ |
| 10 | Streak CRUD APIã‚’å®Ÿè£…ã™ã‚‹ | streak-buddy | Phase 2 Week 4 | â¬œ |
| 11 | Zodãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å…¨APIã«è¿½åŠ ã™ã‚‹ | streak-buddy | Phase 2 Week 4 | â¬œ |
| 12 | Reactãƒ•ãƒ­ãƒ³ãƒˆã‹ã‚‰APIã‚’å‘¼ã³å‡ºã™ | streak-buddy | Phase 3 Week 5 | â¬œ |
| 13 | TanStack Queryã‚’å°å…¥ã™ã‚‹ | streak-buddy | Phase 3 Week 5 | â¬œ |
| 14 | ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã€œãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®èªè¨¼ãƒ•ãƒ­ãƒ¼ã‚’ä½œã‚‹ | streak-buddy | Phase 3 Week 6 | â¬œ |
| 15 | Streakä¸€è¦§ãƒ»ä½œæˆãƒ»ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³æ©Ÿèƒ½ã®UIã‚’ä½œã‚‹ | streak-buddy | Phase 3 Week 6 | â¬œ |
| 16 | ãƒšãƒƒãƒˆè‚²æˆã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿè£…ã™ã‚‹ | streak-buddy | Phase 3 Week 7 | â¬œ |
| 17 | Supabaseã¸ç§»è¡Œã™ã‚‹ (DB + Auth) | streak-buddy | Phase 3 Week 7 | â¬œ |
| 18 | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’Railwayã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ | streak-buddy | Phase 3 Week 8 | â¬œ |
| 19 | ãƒ•ãƒ­ãƒ³ãƒˆã‚’Vercelã«ãƒ‡ãƒ—ãƒ­ã‚¤â†’ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã«ãƒªãƒ³ã‚¯è¿½åŠ  | both | Phase 3 Week 8 | â¬œ |
| 20 | Next.js App Routerã‚’å­¦ã¶ | streak-buddy | Phase 4 | â¬œ |
| 21 | Streak Buddyã‚’Next.js + Supabaseã§ãƒªãƒ©ã‚¤ãƒˆ | streak-buddy | Phase 4 | â¬œ |
| 22 | ãƒ†ã‚¹ãƒˆã‚’æ›¸ã (Vitest + Testing Library) | streak-buddy | Phase 4 | â¬œ |
| 23 | å‹å®‰å…¨ãªAPIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’å®Ÿè£…ã™ã‚‹ | streak-buddy | Phase 4 | â¬œ |
| 24 | ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚’æœ€çµ‚æ•´å‚™ã™ã‚‹ | portfolio | Phase 4 | â¬œ |

---

---

# Phase 1: åŸºç›¤å›ºã‚ (2é€±é–“)

---

## Task 1: ã“ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚’Vercelã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹

**ğŸ“¦ ãƒªãƒã‚¸ãƒˆãƒª**: `platypuscode-portfolio`
**â± ç›®å®‰**: 30åˆ†ã€œ1æ™‚é–“

### ğŸ¯ ã“ã®èª²é¡Œã§å­¦ã¶ã“ã¨

- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ã¯ã©ã†ã„ã†ã“ã¨ã‹
- Vercelã®ä»•çµ„ã¿ (GitHubã¨é€£æºã—ã¦pushã™ã‚‹ãŸã³ã«è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤)
- ãƒ“ãƒ«ãƒ‰ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ã®é•ã„

### ã‚„ã‚‹ã“ã¨ (Step by Step)

```
Step 1: GitHubã«ãƒªãƒã‚¸ãƒˆãƒªã‚’pushã™ã‚‹ (ã¾ã ã®å ´åˆ)
  â†’ VSCodeã®Source Controlãƒ‘ãƒãƒ«ã‹ã‚‰æ“ä½œã§ãã‚‹

Step 2: https://vercel.com ã«ã‚¢ã‚¯ã‚»ã‚¹
  â†’ ã€ŒContinue with GitHubã€ã§ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—

Step 3: ã€ŒNew Projectã€â†’ å¯¾è±¡ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’é¸æŠ

Step 4: Framework Preset: Vite ã‚’é¸æŠ
  â†’ Build Command: npm run build (è‡ªå‹•æ¤œå‡ºã•ã‚Œã‚‹)
  â†’ Output Directory: dist (è‡ªå‹•æ¤œå‡ºã•ã‚Œã‚‹)

Step 5: ã€ŒDeployã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™

Step 6: æ•°åˆ†å¾Œã« https://xxxx.vercel.app ãŒç™ºè¡Œã•ã‚Œã‚‹
  â†’ ã“ã®URLã‚’README.mdã¨ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã®æ¦‚è¦æ¬„ã«è¿½åŠ ã™ã‚‹
```

### ğŸ“š å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹

- [Vercelå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ - Viteã®ãƒ‡ãƒ—ãƒ­ã‚¤](https://vercel.com/docs/frameworks/vite)

### å‚è€ƒã‚³ãƒ¼ãƒ‰

```bash
# ãƒ“ãƒ«ãƒ‰ãŒé€šã‚‹ã‹äº‹å‰ã«ç¢ºèªã™ã‚‹ (ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Œã°ç›´ã™)
npm run build

# ãƒ“ãƒ«ãƒ‰æˆåŠŸã®ã‚µã‚¤ãƒ³:
# dist/ ãƒ•ã‚©ãƒ«ãƒ€ãŒç”Ÿæˆã•ã‚Œã‚‹
# âœ“ built in Xs
```

### âœ… å®Œäº†ã®å®šç¾©

- [ ] `https://xxxx.vercel.app` ã§ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] GitHubã«pushã—ãŸã‚‰è‡ªå‹•ã§å†ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã—ãŸ
- [ ] URLã‚’README.mdã«è¿½åŠ ã—ãŸ
- [ ] roadmap.md ã® Task 1 ã‚’ âœ… ã«æ›´æ–°ã—ãŸ

---

## Task 2: CLAUDE.md ã‚’ä½œæˆã™ã‚‹

**ğŸ“¦ ãƒªãƒã‚¸ãƒˆãƒª**: `platypuscode-portfolio`
**â± ç›®å®‰**: 30åˆ†

### ğŸ¯ ã“ã®èª²é¡Œã§å­¦ã¶ã“ã¨

- CLAUDE.mdãŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã€Œã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ¢ãƒªã€ã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹ä»•çµ„ã¿
- AIã«æ¯å›èª¬æ˜ã›ãšã«æ¸ˆã‚€ç’°å¢ƒã‚’æ•´ãˆã‚‹
- Claude Codeã‚’ã‚ˆã‚Šè³¢ãä½¿ã†ãŸã‚ã®è¨­å®š

### ã‚„ã‚‹ã“ã¨ (Step by Step)

```
Step 1: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã« CLAUDE.md ã‚’ä½œæˆã™ã‚‹

Step 2: ä»¥ä¸‹ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å‚è€ƒã«æ›¸ã

Step 3: Claude Codeã‚’å†èµ·å‹•ã—ã¦ã€CLAUDE.mdãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹
  â†’ ã€Œã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¹ã‚¿ãƒƒã‚¯ã¯ä½•ã§ã™ã‹?ã€ã¨èã„ã¦ã¿ã‚‹
  â†’ CLAUDE.mdã®å†…å®¹ã‚’ç­”ãˆã¦ãã‚Œã‚Œã°OK
```

### ğŸ“š å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹

- [Claude Codeå…¬å¼: CLAUDE.md](https://docs.anthropic.com/en/docs/claude-code/memory)

### å‚è€ƒã‚³ãƒ¼ãƒ‰ (ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ)

```markdown
# platypuscode-portfolio

å€‹äººãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚µã‚¤ãƒˆã€‚åˆ¶ä½œç‰©ã®ç´¹ä»‹ã¨ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’æ²è¼‰ã™ã‚‹ã€‚

## Tech Stack
- Framework: React 18 + TypeScript
- Build Tool: Vite
- Styling: Tailwind CSS
- Routing: React Router v6
- Deploy: Vercel

## Project Structure
- src/components/ â†’ å†åˆ©ç”¨å¯èƒ½ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- src/pages/ â†’ ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- src/assets/ â†’ ç”»åƒãƒ»é™çš„ãƒ•ã‚¡ã‚¤ãƒ«

## Coding Conventions
- TypeScript: strict ãƒ¢ãƒ¼ãƒ‰ã€‚any ã¯ä½¿ã‚ãªã„
- ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®propså‹ã¯ `type Props = {...}` ã§å®šç¾©ã™ã‚‹
- ãƒ•ã‚¡ã‚¤ãƒ«åã¯PascalCase (MyComponent.tsx)
- ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã¯ src/hooks/ ã«ç½®ã

## Commands
- npm run dev   â†’ é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹• (http://localhost:5173)
- npm run build â†’ æœ¬ç•ªãƒ“ãƒ«ãƒ‰
- npm run lint  â†’ ESLintãƒã‚§ãƒƒã‚¯

## Notes
- ã“ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã¯Streak Buddyã‚¢ãƒ—ãƒªã®ãƒªãƒ³ã‚¯ã‚’æ²è¼‰ã™ã‚‹äºˆå®š
- Streak Buddy repo: streak-buddy (åˆ¥ãƒªãƒã‚¸ãƒˆãƒª)
```

### âœ… å®Œäº†ã®å®šç¾©

- [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã« `CLAUDE.md` ãŒå­˜åœ¨ã™ã‚‹
- [ ] Claude Codeã«ã‚¹ã‚¿ãƒƒã‚¯ã‚’èã„ãŸã‚‰ç­”ãˆã¦ãã‚ŒãŸ
- [ ] roadmap.md ã® Task 2 ã‚’ âœ… ã«æ›´æ–°ã—ãŸ

---

## Task 3: TypeScript ã§Streak Buddyã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’å®šç¾©ã™ã‚‹

**ğŸ“¦ ãƒªãƒã‚¸ãƒˆãƒª**: `platypuscode-portfolio` (ç·´ç¿’å ´ã¨ã—ã¦ä½¿ã†ã€‚å¾Œã§streak-buddyã«ã‚³ãƒ”ãƒ¼)
**â± ç›®å®‰**: 1ã€œ2æ™‚é–“

### ğŸ¯ ã“ã®èª²é¡Œã§å­¦ã¶ã“ã¨

- `interface` vs `type` ã®å®Ÿéš›ã®ä½¿ã„åˆ†ã‘
- `Partial<T>`, `Pick<T,K>`, `Omit<T,K>` ã®å®Ÿç”¨çš„ãªä½¿ã„æ–¹
- ã‚¸ã‚§ãƒãƒªãƒƒã‚¯å‹ã®æ›¸ãæ–¹
- å‹è¨­è¨ˆãŒã„ã‹ã«ã‚¢ãƒ—ãƒªè¨­è¨ˆã¨ç›´çµã™ã‚‹ã‹

### ã‚„ã‚‹ã“ã¨ (Step by Step)

```
Step 1: src/types/index.ts ã‚’ä½œæˆã™ã‚‹

Step 2: ä»¥ä¸‹ã®å‹ã‚’è‡ªåˆ†ã§è€ƒãˆãªãŒã‚‰å®šç¾©ã™ã‚‹
  - User (ãƒ¦ãƒ¼ã‚¶ãƒ¼)
  - Streak (ã‚¹ãƒˆãƒªãƒ¼ã‚¯)
  - Pet (ãƒšãƒƒãƒˆ)
  - ãƒ•ã‚©ãƒ¼ãƒ ç”¨ã®å‹ (Utility Typesã‚’ä½¿ã†)

Step 3: å‹ã‚’å®šç¾©ã—ãŸã‚ã¨ã€Claude Codeã«
  ã€Œã“ã®å‹è¨­è¨ˆã§Streak Buddyã‚’ä½œã‚‹å ´åˆã®å•é¡Œç‚¹ã¯ã‚ã‚Šã¾ã™ã‹?ã€
  ã¨èã„ã¦ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ã‚‚ã‚‰ã†
```

### ğŸ“š å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹

- [TypeScript Handbook: Utility Types](https://www.typescriptlang.org/docs/handbook/utility-types.html)
- [Matt Pocock: TypeScript Generics Tutorial](https://www.youtube.com/@mattpocockuk) (YouTube)

### å‚è€ƒã‚³ãƒ¼ãƒ‰

```typescript
// src/types/index.ts

// â”€â”€ ãƒ¦ãƒ¼ã‚¶ãƒ¼ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
export type User = {
  id: string;
  email: string;
  name: string;
  createdAt: Date;
};

// ãƒ•ã‚©ãƒ¼ãƒ ã§ä½¿ã†: id ã¨ createdAt ã¯è‡ªå‹•ç”Ÿæˆãªã®ã§é™¤å¤–
export type CreateUserInput = Omit<User, 'id' | 'createdAt'> & {
  password: string;
};

// æ›´æ–°ã§ä½¿ã†: å…¨éƒ¨ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ã€å¤‰ãˆãŸã„ã‚‚ã®ã ã‘é€ã‚Œã°ã„ã„
export type UpdateUserInput = Partial<Pick<User, 'name' | 'email'>>;

// â”€â”€ ã‚¹ãƒˆãƒªãƒ¼ã‚¯ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
export type Streak = {
  id: string;
  userId: string;
  title: string;
  description?: string;        // ? = ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«
  currentStreak: number;
  longestStreak: number;
  lastCheckedDate: Date | null; // ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³æœªå®Ÿæ–½ã®å ´åˆã¯null
  createdAt: Date;
};

// ä½œæˆæ™‚: idç³»ãƒ»å®Ÿç¸¾ç³»ã¯è‡ªå‹•è¨ˆç®—ãªã®ã§é™¤å¤–
export type CreateStreakInput = Pick<Streak, 'title' | 'description'>;

// â”€â”€ ãƒšãƒƒãƒˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
export type PetMood = 'happy' | 'normal' | 'sad'; // â† ãƒ¦ãƒ‹ã‚ªãƒ³å‹ãŒä¾¿åˆ©ãªå ´é¢

export type Pet = {
  id: string;
  userId: string;
  name: string;
  level: number;
  experience: number;
  mood: PetMood;
  items: string[];             // æŒã£ã¦ã„ã‚‹ã‚¢ã‚¤ãƒ†ãƒ ã®idä¸€è¦§
  createdAt: Date;
};

// â”€â”€ APIãƒ¬ã‚¹ãƒãƒ³ã‚¹å…±é€šå‹ (ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã®å®Ÿè·µ) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
export type ApiResponse<T> = {
  data: T;
  message: string;
};

export type ApiError = {
  error: string;
  details?: string[];
};

// ä½¿ã„æ–¹ã®ä¾‹:
// const response: ApiResponse<Streak[]> = await fetchStreaks();
// response.data â†’ Streak[] å‹ã«ãªã‚‹
```

### âœ… å®Œäº†ã®å®šç¾©

- [ ] `src/types/index.ts` ãŒä½œæˆã•ã‚ŒãŸ
- [ ] `User`, `Streak`, `Pet` ã®3ã¤ã®å‹ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹
- [ ] `Partial`, `Pick`, `Omit` ã‚’å°‘ãªãã¨ã‚‚1å›ãšã¤ä½¿ã£ãŸ
- [ ] Claude Codeã«ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ã‚‚ã‚‰ã„ã€å•é¡ŒãŒãªã‘ã‚Œã°OK
- [ ] roadmap.md ã® Task 3 ã‚’ âœ… ã«æ›´æ–°ã—ãŸ

---

## Task 4: useLocalStorage ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’ä½œã‚‹

**ğŸ“¦ ãƒªãƒã‚¸ãƒˆãƒª**: `platypuscode-portfolio`
**â± ç›®å®‰**: 1ã€œ2æ™‚é–“

### ğŸ¯ ã“ã®èª²é¡Œã§å­¦ã¶ã“ã¨

- ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã¨ã¯ä½•ã‹ã€ãªãœä½œã‚‹ã®ã‹
- TypeScript ã®ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã‚’å®Ÿéš›ã«ä½¿ã†
- localStorage ã®æ“ä½œæ–¹æ³•

### ã‚„ã‚‹ã“ã¨ (Step by Step)

```
Step 1: src/hooks/useLocalStorage.ts ã‚’ä½œæˆã™ã‚‹

Step 2: ã‚¸ã‚§ãƒãƒªãƒƒã‚¯å‹ T ã‚’ä½¿ã£ãŸãƒ•ãƒƒã‚¯ã‚’æ›¸ã
  - useState ã¨åŒã˜ä½¿ã„å¿ƒåœ°ã«ã™ã‚‹
  - const [value, setValue] = useLocalStorage('key', defaultValue)

Step 3: ã“ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã®ä¸­ã§ä½¿ã£ã¦ã¿ã‚‹
  ä¾‹: ãƒ†ãƒ¼ãƒè¨­å®šã€æœ€å¾Œã«è¦‹ãŸãƒšãƒ¼ã‚¸ã€ãªã©ä½•ã§ã‚‚OK
  (å®Ÿéš›ã«å‹•ã‹ã™ã“ã¨ãŒç›®çš„)
```

### ğŸ“š å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹

- [React Docs: Reusing Logic with Custom Hooks](https://react.dev/learn/reusing-logic-with-custom-hooks)
- [Web Dev Simplified: Custom Hooks Tutorial](https://www.youtube.com/@WebDevSimplified) (YouTube ã§ "custom hooks" ã§æ¤œç´¢)

### å‚è€ƒã‚³ãƒ¼ãƒ‰

```typescript
// src/hooks/useLocalStorage.ts
import { useState, useEffect } from 'react';

// ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ <T> = ã€Œã©ã‚“ãªå‹ã§ã‚‚å…¥ã‚Œã‚‰ã‚Œã‚‹ã€ã¨ã„ã†å®£è¨€
function useLocalStorage<T>(key: string, initialValue: T) {
  // Step 1: localStorageã‹ã‚‰åˆæœŸå€¤ã‚’èª­ã¿è¾¼ã‚€
  const [storedValue, setStoredValue] = useState<T>(() => {
    try {
      const item = localStorage.getItem(key);
      // ä¿å­˜ã•ã‚Œã¦ã„ã‚Œã°ãƒ‘ãƒ¼ã‚¹ã€ãªã‘ã‚Œã°initialValueã‚’ä½¿ã†
      return item ? (JSON.parse(item) as T) : initialValue;
    } catch (error) {
      console.warn(`useLocalStorage: ã‚­ãƒ¼ "${key}" ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—`, error);
      return initialValue;
    }
  });

  // Step 2: å€¤ãŒå¤‰ã‚ã£ãŸã‚‰localStorageã«ä¿å­˜ã™ã‚‹
  useEffect(() => {
    try {
      localStorage.setItem(key, JSON.stringify(storedValue));
    } catch (error) {
      console.warn(`useLocalStorage: ã‚­ãƒ¼ "${key}" ã®ä¿å­˜ã«å¤±æ•—`, error);
    }
  }, [key, storedValue]);

  return [storedValue, setStoredValue] as const;
  // as const = useState ã¨åŒã˜ã‚ˆã†ã« [value, setter] ã®ã‚¿ãƒ—ãƒ«ã¨ã—ã¦è¿”ã™
}

export default useLocalStorage;

// â”€â”€â”€ ä½¿ã„æ–¹ã®ä¾‹ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// const [username, setUsername] = useLocalStorage<string>('username', '');
// const [count, setCount] = useLocalStorage<number>('count', 0);
// const [user, setUser] = useLocalStorage<User | null>('user', null);
```

```typescript
// å®Ÿéš›ã«ä½¿ã†ä¾‹ (ã©ã“ã‹ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§è©¦ã—ã¦ã¿ã‚‹)
import useLocalStorage from '../hooks/useLocalStorage';

function ThemeToggle() {
  const [theme, setTheme] = useLocalStorage<'light' | 'dark'>('theme', 'light');

  return (
    <button onClick={() => setTheme(theme === 'light' ? 'dark' : 'light')}>
      ç¾åœ¨: {theme}
    </button>
  );
}
// â†’ ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚‚ theme ãŒä¿æŒã•ã‚Œã‚‹!
```

### âœ… å®Œäº†ã®å®šç¾©

- [ ] `src/hooks/useLocalStorage.ts` ãŒä½œæˆã•ã‚ŒãŸ
- [ ] ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ `<T>` ã‚’ä½¿ã£ã¦ã„ã‚‹
- [ ] å®Ÿéš›ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ä½¿ã£ã¦å‹•ä½œç¢ºèªã—ãŸ
- [ ] ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚‚å€¤ãŒä¿æŒã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã—ãŸ
- [ ] roadmap.md ã® Task 4 ã‚’ âœ… ã«æ›´æ–°ã—ãŸ

---

## Task 5: Streak Buddy ãƒªãƒã‚¸ãƒˆãƒªã‚’åˆæœŸåŒ–ã™ã‚‹

**ğŸ“¦ ãƒªãƒã‚¸ãƒˆãƒª**: `streak-buddy` (æ–°è¦ä½œæˆ)
**â± ç›®å®‰**: 1æ™‚é–“

### ğŸ¯ ã“ã®èª²é¡Œã§å­¦ã¶ã“ã¨

- ãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ã®è¨­è¨ˆ
- ãƒ¢ãƒãƒ¬ãƒ vs ãƒãƒ«ãƒãƒ¬ãƒã®è€ƒãˆæ–¹
- æ–°ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸè¨­å®š

### ã‚„ã‚‹ã“ã¨ (Step by Step)

```
Step 1: GitHubã§ "streak-buddy" ã¨ã„ã†æ–°ã—ã„ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œæˆã™ã‚‹

Step 2: ãƒ­ãƒ¼ã‚«ãƒ«ã«ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¦ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ã‚’ä½œã‚‹
streak-buddy/
  â”œâ”€â”€ frontend/          â† React + Vite
  â”œâ”€â”€ backend/           â† Express + Node.js
  â”œâ”€â”€ docs/              â† ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã‚³ãƒ”ãƒ¼
  â””â”€â”€ README.md

Step 3: frontendã‚’ Vite + React + TypeScript ã§åˆæœŸåŒ–ã™ã‚‹
  cd frontend
  npm create vite@latest . -- --template react-ts
  npm install
  npm install -D tailwindcss postcss autoprefixer
  npx tailwindcss init -p

Step 4: backendãƒ•ã‚©ãƒ«ãƒ€ã‚’åˆæœŸåŒ–ã™ã‚‹
  cd backend
  npm init -y
  npm install express cors dotenv
  npm install -D typescript @types/node @types/express ts-node-dev

Step 5: ã“ã®docsãƒ•ã‚©ãƒ«ãƒ€ã®å†…å®¹ã‚’streak-buddyã®docs/ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹
  docs/learning-plan.md (ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«)
  docs/roadmap.md
  docs/feedback.md

Step 6: streak-buddyã«CLAUDE.mdã‚’ä½œæˆã™ã‚‹ (Task 2ã‚’å‚è€ƒã«)

Step 7: platypuscode-portfolioã®CLAUDE.mdã«Streak Buddyã¸ã®å‚ç…§ã‚’è¿½åŠ ã™ã‚‹
```

### ğŸ“š å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹

- [Viteå…¬å¼: React + TypeScriptãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ](https://vitejs.dev/guide/)
- [Tailwind CSS: Viteã¨ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](https://tailwindcss.com/docs/guides/vite)

### å‚è€ƒã‚³ãƒ¼ãƒ‰

```bash
# streak-buddy/frontend ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
npm create vite@latest . -- --template react-ts
npm install
npm install -D tailwindcss postcss autoprefixer
npx tailwindcss init -p

# tailwind.config.js ã«è¿½è¨˜
content: ["./index.html", "./src/**/*.{js,ts,jsx,tsx}"]

# src/index.css ã®å…ˆé ­ã«è¿½åŠ 
@tailwind base;
@tailwind components;
@tailwind utilities;
```

```bash
# streak-buddy/backend ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
npm init -y
npm install express cors dotenv cookie-parser
npm install -D typescript @types/node @types/express @types/cors @types/cookie-parser ts-node-dev
npx tsc --init
```

```json
// backend/package.json ã® scripts ã«è¿½åŠ 
{
  "scripts": {
    "dev": "ts-node-dev --respawn src/index.ts",
    "build": "tsc",
    "start": "node dist/index.js"
  }
}
```

```typescript
// backend/src/index.ts (æœ€åˆã®å‹•ä½œç¢ºèªç”¨)
import express from 'express';
import cors from 'cors';

const app = express();
const PORT = process.env.PORT || 3001;

app.use(cors({ origin: 'http://localhost:5173' }));
app.use(express.json());

app.get('/api/health', (req, res) => {
  res.json({ status: 'ok', message: 'Streak Buddy API is running!' });
});

app.listen(PORT, () => {
  console.log(`Server running on http://localhost:${PORT}`);
});
```

### streak-buddy/docs/CLAUDE.md ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

```markdown
# Streak Buddy

ç¿’æ…£ç¶™ç¶š (ã‚¹ãƒˆãƒªãƒ¼ã‚¯) Ã— ãƒãƒ¼ãƒãƒ£ãƒ«ãƒšãƒƒãƒˆè‚²æˆã®ã‚²ãƒ¼ãƒŸãƒ•ã‚£ã‚±ãƒ¼ã‚·ãƒ§ãƒ³Webã‚¢ãƒ—ãƒªã€‚

## Tech Stack
- Frontend: React 18 + TypeScript + Vite + Tailwind CSS
- Backend: Node.js + Express + TypeScript
- DB: PostgreSQL + Prisma (é–‹ç™ºä¸­ã¯SQLite)
- Auth: JWT + bcrypt + HttpOnly Cookie
- Deploy: Frontendâ†’Vercel / Backendâ†’Railway

## Project Structure
streak-buddy/
  frontend/src/
    components/  â†’ å†åˆ©ç”¨å¯èƒ½ãªUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    pages/       â†’ ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    hooks/       â†’ ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
    lib/         â†’ APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã€ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
    types/       â†’ TypeScriptå‹å®šç¾©
  backend/src/
    routes/      â†’ Expressãƒ«ãƒ¼ã‚¿ãƒ¼
    middleware/  â†’ èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãªã©
    lib/         â†’ Prismaã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãªã©
  docs/          â†’ å­¦ç¿’ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

## Conventions
- TypeScript: any ã¯çµ¶å¯¾ã«ä½¿ã‚ãªã„
- API: RESTfulè¨­è¨ˆã€ã‚¨ãƒ©ãƒ¼ã¯å¿…ãšstatusCodeã¨ä¸€ç·’ã«è¿”ã™
- èªè¨¼: JWTã‚’HttpOnly Cookieã«ä¿å­˜ã™ã‚‹

## Commands
- Frontend: cd frontend && npm run dev (http://localhost:5173)
- Backend: cd backend && npm run dev  (http://localhost:3001)
- DB GUI: npx prisma studio
```

### âœ… å®Œäº†ã®å®šç¾©

- [ ] GitHubã« `streak-buddy` ãƒªãƒã‚¸ãƒˆãƒªãŒä½œæˆã•ã‚ŒãŸ
- [ ] `frontend/` ã¨ `backend/` ã®ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ãŒä½œã‚‰ã‚ŒãŸ
- [ ] `npm run dev` ã§ãƒ•ãƒ­ãƒ³ãƒˆã¨ãƒãƒƒã‚¯ãŒä¸¡æ–¹èµ·å‹•ã™ã‚‹
- [ ] `GET /api/health` ãŒ `{ status: 'ok' }` ã‚’è¿”ã™
- [ ] `docs/` ã«ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒã‚³ãƒ”ãƒ¼ã•ã‚ŒãŸ
- [ ] `CLAUDE.md` ãŒä½œæˆã•ã‚ŒãŸ
- [ ] roadmap.md ã® Task 5 ã‚’ âœ… ã«æ›´æ–°ã—ãŸ

---

## Task 6: GitHub APIã§fetchç·´ç¿’ã‚’ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã«è¿½åŠ ã™ã‚‹

**ğŸ“¦ ãƒªãƒã‚¸ãƒˆãƒª**: `platypuscode-portfolio`
**â± ç›®å®‰**: 2ã€œ3æ™‚é–“

### ğŸ¯ ã“ã®èª²é¡Œã§å­¦ã¶ã“ã¨

- `fetch` APIã®æ­£ã—ã„ä½¿ã„æ–¹
- loading / error / data ã®çŠ¶æ…‹ç®¡ç†ãƒ‘ã‚¿ãƒ¼ãƒ³
- TypeScript ã§ APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å‹ã‚’ã¤ã‘ã‚‹æ–¹æ³•
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å®Ÿè£…

### ã‚„ã‚‹ã“ã¨ (Step by Step)

```
Step 1: ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã«ã€ŒGitHub Profileã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã™ã‚‹

Step 2: fetch ã§ GitHub API ã‚’å©ã
  URL: https://api.github.com/users/{username}
  â†’ ç™»éŒ²ä¸è¦ã€ç„¡æ–™ã§ä½¿ãˆã‚‹å…¬é–‹API

Step 3: loading/error/dataã®çŠ¶æ…‹ã‚’useStateã§ç®¡ç†ã™ã‚‹

Step 4: è¡¨ç¤º: ã‚¢ãƒã‚¿ãƒ¼ç”»åƒãƒ»åå‰ãƒ»ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼æ•°ãƒ»ãƒªãƒã‚¸ãƒˆãƒªæ•°
```

### ğŸ“š å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹

- [MDN: Fetch API](https://developer.mozilla.org/ja/docs/Web/API/Fetch_API/Using_Fetch)
- [GitHub REST API docs: Get a user](https://docs.github.com/en/rest/users/users?apiVersion=2022-11-28#get-a-user)

### å‚è€ƒã‚³ãƒ¼ãƒ‰

```typescript
// src/types/github.ts
// GitHub APIã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹å‹ (å¿…è¦ãªéƒ¨åˆ†ã ã‘)
export type GitHubUser = {
  login: string;
  name: string | null;
  avatar_url: string;
  html_url: string;
  bio: string | null;
  public_repos: number;
  followers: number;
  following: number;
};
```

```typescript
// src/components/GitHubProfile.tsx
import { useState, useEffect } from 'react';
import type { GitHubUser } from '../types/github';

type Props = {
  username: string;
};

function GitHubProfile({ username }: Props) {
  const [user, setUser] = useState<GitHubUser | null>(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    setLoading(true);
    setError(null);

    fetch(`https://api.github.com/users/${username}`)
      .then((res) => {
        // âš ï¸ fetchã®ç½ : 404ã§ã‚‚ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãªã„
        if (!res.ok) {
          throw new Error(`ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ (${res.status})`);
        }
        return res.json();
      })
      .then((data: GitHubUser) => setUser(data))
      .catch((err: Error) => setError(err.message))
      .finally(() => setLoading(false));
  }, [username]);

  if (loading) return <div className="text-gray-500">èª­ã¿è¾¼ã¿ä¸­...</div>;
  if (error) return <div className="text-red-500">ã‚¨ãƒ©ãƒ¼: {error}</div>;
  if (!user) return null;

  return (
    <div className="flex items-center gap-4 p-4 border rounded-lg">
      <img
        src={user.avatar_url}
        alt={user.login}
        className="w-16 h-16 rounded-full"
      />
      <div>
        <h3 className="font-bold">{user.name ?? user.login}</h3>
        {user.bio && <p className="text-sm text-gray-600">{user.bio}</p>}
        <div className="flex gap-4 mt-1 text-sm">
          <span>ğŸ“ {user.public_repos} repos</span>
          <span>ğŸ‘¥ {user.followers} followers</span>
        </div>
      </div>
    </div>
  );
}

export default GitHubProfile;
```

```typescript
// ä½¿ã„æ–¹
<GitHubProfile username="ã‚ãªãŸã®GitHubãƒ¦ãƒ¼ã‚¶ãƒ¼å" />
```

### âœ… å®Œäº†ã®å®šç¾©

- [ ] ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã«GitHubæƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹
- [ ] loadingä¸­ã¯ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºãŒã‚ã‚‹
- [ ] å­˜åœ¨ã—ãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’æ¸¡ã—ãŸã¨ãã‚¨ãƒ©ãƒ¼è¡¨ç¤ºãŒã‚ã‚‹
- [ ] `fetch()` ã® `.ok` ãƒã‚§ãƒƒã‚¯ã‚’ã—ã¦ã„ã‚‹
- [ ] APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å‹ (`GitHubUser`) ãŒã¤ã„ã¦ã„ã‚‹
- [ ] roadmap.md ã® Task 6 ã‚’ âœ… ã«æ›´æ–°ã—ãŸ

---

---

# Phase 2: Streak Buddyã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’ä½œã‚‹ (2é€±é–“)

---

## Task 7: Express + TypeScript APIã‚µãƒ¼ãƒãƒ¼ã‚’ç«‹ã¡ä¸Šã’ã‚‹

**ğŸ“¦ ãƒªãƒã‚¸ãƒˆãƒª**: `streak-buddy/backend/`
**â± ç›®å®‰**: 2ã€œ3æ™‚é–“

### ğŸ¯ ã“ã®èª²é¡Œã§å­¦ã¶ã“ã¨

- RESTful APIã®è¨­è¨ˆåŸå‰‡
- Expressã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¨ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®ä»•çµ„ã¿
- HTTPãƒ¡ã‚½ãƒƒãƒ‰ã¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã®ä½¿ã„åˆ†ã‘
- ç’°å¢ƒå¤‰æ•° (.env) ã®ç®¡ç†

### ã‚„ã‚‹ã“ã¨ (Step by Step)

```
Step 1: Task 5 ã§ä½œã£ãŸã‚µãƒ¼ãƒãƒ¼ã‚’æ‹¡å¼µã™ã‚‹

Step 2: .env ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ PORT ã¨ DATABASE_URL ã‚’ç®¡ç†ã™ã‚‹

Step 3: ãƒ«ãƒ¼ã‚¿ãƒ¼ã‚’åˆ†é›¢ã™ã‚‹ (routes/ ãƒ•ã‚©ãƒ«ãƒ€)
  - routes/health.ts
  - routes/streaks.ts (ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã§)

Step 4: ãƒ«ãƒ¼ã‚¿ãƒ¼ã‚’ index.ts ã«ç™»éŒ²ã™ã‚‹

Step 5: ãƒ•ãƒ­ãƒ³ãƒˆã‹ã‚‰ fetch ã—ã¦ CORS ã‚’ç¢ºèªã™ã‚‹
```

### ğŸ“š å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹

- [Expresså…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: Routing](https://expressjs.com/en/guide/routing.html)
- [Expresså…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: Middleware](https://expressjs.com/en/guide/using-middleware.html)

### å‚è€ƒã‚³ãƒ¼ãƒ‰

```bash
# .env ãƒ•ã‚¡ã‚¤ãƒ« (backend/.env)
PORT=3001
DATABASE_URL="file:./dev.db"
JWT_SECRET="your-secret-key-change-this-in-production"
FRONTEND_URL="http://localhost:5173"
```

```typescript
// backend/src/routes/streaks.ts
import { Router } from 'express';

const router = Router();

// ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ (å¾Œã§DBã«ç½®ãæ›ãˆã‚‹)
const dummyStreaks = [
  { id: '1', title: 'æ¯æ—¥èª­æ›¸', currentStreak: 5, longestStreak: 10 },
  { id: '2', title: 'ç­‹ãƒˆãƒ¬', currentStreak: 3, longestStreak: 7 },
];

// GET /api/streaks â†’ ä¸€è¦§å–å¾—
router.get('/', (req, res) => {
  res.json(dummyStreaks);
});

// GET /api/streaks/:id â†’ 1ä»¶å–å¾—
router.get('/:id', (req, res) => {
  const streak = dummyStreaks.find(s => s.id === req.params.id);
  if (!streak) {
    return res.status(404).json({ error: 'Streak not found' });
  }
  res.json(streak);
});

// POST /api/streaks â†’ æ–°è¦ä½œæˆ
router.post('/', (req, res) => {
  const { title } = req.body;
  if (!title) {
    return res.status(400).json({ error: 'title ã¯å¿…é ˆã§ã™' });
  }
  const newStreak = {
    id: String(dummyStreaks.length + 1),
    title,
    currentStreak: 0,
    longestStreak: 0,
  };
  dummyStreaks.push(newStreak);
  res.status(201).json(newStreak); // 201 = Created
});

export default router;
```

```typescript
// backend/src/index.ts (æ›´æ–°ç‰ˆ)
import express from 'express';
import cors from 'cors';
import dotenv from 'dotenv';
import streaksRouter from './routes/streaks';

dotenv.config();

const app = express();
const PORT = process.env.PORT || 3001;

// ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
app.use(cors({ origin: process.env.FRONTEND_URL }));
app.use(express.json());           // req.body ã‚’JSONã¨ã—ã¦èª­ã‚€

// ãƒ«ãƒ¼ãƒˆ
app.use('/api/streaks', streaksRouter);
app.get('/api/health', (req, res) => res.json({ status: 'ok' }));

// 404ãƒãƒ³ãƒ‰ãƒ©ãƒ¼
app.use((req, res) => {
  res.status(404).json({ error: 'Not found' });
});

app.listen(PORT, () => {
  console.log(`âœ… Server: http://localhost:${PORT}`);
});
```

### âœ… å®Œäº†ã®å®šç¾©

- [ ] `GET /api/streaks` ãŒ JSONé…åˆ—ã‚’è¿”ã™
- [ ] `POST /api/streaks` ã§ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ã§ãã‚‹
- [ ] `GET /api/streaks/999` ã§ 404 ãŒè¿”ã‚‹
- [ ] `.env` ã§ PORT ã‚’ç®¡ç†ã—ã¦ã„ã‚‹
- [ ] ãƒ«ãƒ¼ã‚¿ãƒ¼ãŒ `routes/` ãƒ•ã‚©ãƒ«ãƒ€ã«åˆ†é›¢ã•ã‚Œã¦ã„ã‚‹
- [ ] roadmap.md ã® Task 7 ã‚’ âœ… ã«æ›´æ–°ã—ãŸ

---

## Task 8: Prisma + SQLite ã§DBã«ç¹‹ã

**ğŸ“¦ ãƒªãƒã‚¸ãƒˆãƒª**: `streak-buddy/backend/`
**â± ç›®å®‰**: 3ã€œ4æ™‚é–“

### ğŸ¯ ã“ã®èª²é¡Œã§å­¦ã¶ã“ã¨

- ORMã¨ã¯ä½•ã‹ã€ãªãœä½¿ã†ã®ã‹
- Prismaã®ã‚¹ã‚­ãƒ¼ãƒå®šç¾©ã¨ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- DBã‹ã‚‰CRUDã™ã‚‹ã‚³ãƒ¼ãƒ‰ã®æ›¸ãæ–¹
- SQLiteã§ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã™ã‚‹æ–¹æ³•

### ã‚„ã‚‹ã“ã¨ (Step by Step)

```
Step 1: Prisma ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹

Step 2: prisma/schema.prisma ã« User, Streak, Pet ã®ãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾©ã™ã‚‹

Step 3: npx prisma migrate dev ã§DBã‚’ä½œæˆã™ã‚‹

Step 4: npx prisma studio ã§DBã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ç¢ºèªã™ã‚‹

Step 5: ãƒ«ãƒ¼ã‚¿ãƒ¼ã®ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’DBæ“ä½œã«ç½®ãæ›ãˆã‚‹
```

### ğŸ“š å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹

- [Prismaå…¬å¼: Getting Started](https://www.prisma.io/docs/getting-started/setup-prisma/start-from-scratch)
- [Prismaå…¬å¼: CRUD Operations](https://www.prisma.io/docs/orm/prisma-client/queries/crud)

### å‚è€ƒã‚³ãƒ¼ãƒ‰

```bash
# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install prisma @prisma/client
npx prisma init --datasource-provider sqlite
```

```prisma
// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  name      String
  password  String   // bcryptãƒãƒƒã‚·ãƒ¥åŒ–ã•ã‚ŒãŸã‚‚ã®
  createdAt DateTime @default(now())
  streaks   Streak[]
  pet       Pet?
}

model Streak {
  id               String    @id @default(cuid())
  userId           String
  title            String
  description      String?
  currentStreak    Int       @default(0)
  longestStreak    Int       @default(0)
  lastCheckedDate  DateTime?
  createdAt        DateTime  @default(now())
  user             User      @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model Pet {
  id         String   @id @default(cuid())
  userId     String   @unique
  name       String   @default("ãŸã¾ã”")
  level      Int      @default(1)
  experience Int      @default(0)
  mood       String   @default("normal") // happy | normal | sad
  items      String   @default("[]")     // JSONæ–‡å­—åˆ—ã¨ã—ã¦ä¿å­˜
  createdAt  DateTime @default(now())
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}
```

```bash
# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ (ã‚¹ã‚­ãƒ¼ãƒã‚’DBã«åæ˜ ã™ã‚‹)
npx prisma migrate dev --name init

# ãƒ–ãƒ©ã‚¦ã‚¶ã§DBç¢ºèª
npx prisma studio
```

```typescript
// src/lib/prisma.ts (Prismaã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³)
import { PrismaClient } from '@prisma/client';

const globalForPrisma = global as unknown as { prisma: PrismaClient };

export const prisma =
  globalForPrisma.prisma ??
  new PrismaClient({ log: ['query'] });

if (process.env.NODE_ENV !== 'production') {
  globalForPrisma.prisma = prisma;
}
```

```typescript
// routes/streaks.ts ã‚’DBç‰ˆã«æ›´æ–°
import { Router } from 'express';
import { prisma } from '../lib/prisma';

const router = Router();

router.get('/', async (req, res) => {
  try {
    const streaks = await prisma.streak.findMany({
      orderBy: { createdAt: 'desc' },
    });
    res.json(streaks);
  } catch (error) {
    res.status(500).json({ error: 'ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ' });
  }
});

router.post('/', async (req, res) => {
  try {
    const { title, description, userId } = req.body;
    const streak = await prisma.streak.create({
      data: { title, description, userId },
    });
    res.status(201).json(streak);
  } catch (error) {
    res.status(500).json({ error: 'ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ' });
  }
});

export default router;
```

### âœ… å®Œäº†ã®å®šç¾©

- [ ] `prisma/schema.prisma` ã«3ã¤ã®ãƒ¢ãƒ‡ãƒ«ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹
- [ ] `npx prisma migrate dev` ãŒæˆåŠŸã—ãŸ
- [ ] `npx prisma studio` ã§DBå†…å®¹ãŒãƒ–ãƒ©ã‚¦ã‚¶ã§è¦‹ãˆã‚‹
- [ ] APIãŒãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã§ã¯ãªãDBã‹ã‚‰èª­ã¿æ›¸ãã™ã‚‹
- [ ] roadmap.md ã® Task 8 ã‚’ âœ… ã«æ›´æ–°ã—ãŸ

---

## Task 9: ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ãƒ»ãƒ­ã‚°ã‚¤ãƒ³APIã‚’å®Ÿè£…ã™ã‚‹

**ğŸ“¦ ãƒªãƒã‚¸ãƒˆãƒª**: `streak-buddy/backend/`
**â± ç›®å®‰**: 4ã€œ6æ™‚é–“

### ğŸ¯ ã“ã®èª²é¡Œã§å­¦ã¶ã“ã¨

- bcrypt ã«ã‚ˆã‚‹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ãƒãƒƒã‚·ãƒ¥åŒ–
- JWTã®ç”Ÿæˆã¨æ¤œè¨¼
- HttpOnly Cookie ã®è¨­å®š
- èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®å®Ÿè£…
- ãƒ•ãƒ­ãƒ³ãƒˆã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ãƒãƒƒã‚·ãƒ¥ã—ã¦ã¯ã„ã‘ãªã„ç†ç”±ã®ä½“æ„Ÿ

### ã‚„ã‚‹ã“ã¨ (Step by Step)

```
Step 1: bcrypt, jsonwebtoken ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹

Step 2: routes/auth.ts ã‚’ä½œæˆã™ã‚‹
  POST /api/auth/register
  POST /api/auth/login
  GET  /api/auth/me
  POST /api/auth/logout

Step 3: èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’ä½œæˆã™ã‚‹
  middleware/auth.ts

Step 4: ä¿è­·ã•ã‚ŒãŸãƒ«ãƒ¼ãƒˆ (èªè¨¼ãŒå¿…è¦ãªãƒ«ãƒ¼ãƒˆ) ã«ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’è¿½åŠ ã™ã‚‹
```

### ğŸ“š å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹

- [bcrypt npm ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸](https://www.npmjs.com/package/bcrypt)
- [jsonwebtoken npm ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸](https://www.npmjs.com/package/jsonwebtoken)

### å‚è€ƒã‚³ãƒ¼ãƒ‰

```bash
npm install bcrypt jsonwebtoken cookie-parser
npm install -D @types/bcrypt @types/jsonwebtoken @types/cookie-parser
```

```typescript
// src/routes/auth.ts
import { Router } from 'express';
import bcrypt from 'bcrypt';
import jwt from 'jsonwebtoken';
import { prisma } from '../lib/prisma';

const router = Router();
const JWT_SECRET = process.env.JWT_SECRET!;

// â”€â”€ ç™»éŒ² â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
router.post('/register', async (req, res) => {
  try {
    const { email, name, password } = req.body;

    // æ—¢å­˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒã‚§ãƒƒã‚¯
    const existing = await prisma.user.findUnique({ where: { email } });
    if (existing) {
      return res.status(400).json({ error: 'ã“ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯ã™ã§ã«ä½¿ã‚ã‚Œã¦ã„ã¾ã™' });
    }

    // âš ï¸ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ãƒãƒƒã‚·ãƒ¥åŒ–ã¯ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§è¡Œã†!
    const hashedPassword = await bcrypt.hash(password, 10);

    // ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ
    const user = await prisma.user.create({
      data: { email, name, password: hashedPassword },
    });

    // ãƒšãƒƒãƒˆã‚‚ä¸€ç·’ã«ä½œæˆ
    await prisma.pet.create({ data: { userId: user.id } });

    res.status(201).json({ message: 'ç™»éŒ²å®Œäº†', userId: user.id });
  } catch (error) {
    res.status(500).json({ error: 'ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼' });
  }
});

// â”€â”€ ãƒ­ã‚°ã‚¤ãƒ³ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
router.post('/login', async (req, res) => {
  try {
    const { email, password } = req.body;

    // ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢
    const user = await prisma.user.findUnique({ where: { email } });
    if (!user) {
      // â€» ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå­˜åœ¨ã—ãªã„ã€ã¨ã€Œãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã†ã€ã‚’åŒºåˆ¥ã—ãªã„ã®ãŒã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šæ­£ã—ã„
      return res.status(401).json({ error: 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã„ã¾ã™' });
    }

    // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ¤œè¨¼ (å…¥åŠ›å€¤ vs DBã®ãƒãƒƒã‚·ãƒ¥)
    const isValid = await bcrypt.compare(password, user.password);
    if (!isValid) {
      return res.status(401).json({ error: 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã„ã¾ã™' });
    }

    // JWTç”Ÿæˆ
    const token = jwt.sign({ userId: user.id }, JWT_SECRET, { expiresIn: '7d' });

    // HttpOnly Cookie ã«ã‚»ãƒƒãƒˆ (JavaScriptã‹ã‚‰èª­ã‚ãªã„ = XSSå¯¾ç­–)
    res.cookie('token', token, {
      httpOnly: true,
      secure: process.env.NODE_ENV === 'production', // æœ¬ç•ªã¯HTTPSã®ã¿
      sameSite: 'strict',
      maxAge: 7 * 24 * 60 * 60 * 1000, // 7æ—¥é–“
    });

    res.json({ message: 'ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ', user: { id: user.id, name: user.name, email: user.email } });
  } catch (error) {
    res.status(500).json({ error: 'ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼' });
  }
});

// â”€â”€ ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾— â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
router.get('/me', async (req, res) => {
  try {
    const token = req.cookies?.token;
    if (!token) return res.status(401).json({ error: 'ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„' });

    const decoded = jwt.verify(token, JWT_SECRET) as { userId: string };
    const user = await prisma.user.findUnique({
      where: { id: decoded.userId },
      select: { id: true, name: true, email: true, createdAt: true }, // passwordã¯çµ¶å¯¾ã«è¿”ã•ãªã„
    });
    if (!user) return res.status(401).json({ error: 'ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“' });

    res.json(user);
  } catch (error) {
    res.status(401).json({ error: 'ãƒˆãƒ¼ã‚¯ãƒ³ãŒç„¡åŠ¹ã§ã™' });
  }
});

// â”€â”€ ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
router.post('/logout', (req, res) => {
  res.clearCookie('token');
  res.json({ message: 'ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæˆåŠŸ' });
});

export default router;
```

```typescript
// src/middleware/auth.ts (ä¿è­·ã•ã‚ŒãŸãƒ«ãƒ¼ãƒˆã§ä½¿ã†)
import { Request, Response, NextFunction } from 'express';
import jwt from 'jsonwebtoken';

export function authMiddleware(req: Request, res: Response, next: NextFunction) {
  const token = req.cookies?.token;
  if (!token) {
    return res.status(401).json({ error: 'ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™' });
  }
  try {
    const decoded = jwt.verify(token, process.env.JWT_SECRET!) as { userId: string };
    (req as any).userId = decoded.userId; // å¾Œç¶šã®å‡¦ç†ã§userIdã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹
    next(); // æ¬¡ã®å‡¦ç†ã¸é€²ã‚€
  } catch {
    res.status(401).json({ error: 'ãƒˆãƒ¼ã‚¯ãƒ³ãŒç„¡åŠ¹ã¾ãŸã¯æœŸé™åˆ‡ã‚Œã§ã™' });
  }
}
```

```typescript
// index.ts ã« cookie-parser ã‚’è¿½åŠ 
import cookieParser from 'cookie-parser';
app.use(cookieParser());
app.use('/api/auth', authRouter);
```

### âœ… å®Œäº†ã®å®šç¾©

- [ ] `POST /api/auth/register` ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½œæˆã•ã‚Œã‚‹
- [ ] `POST /api/auth/login` ã§JWTãŒCookieã«ã‚»ãƒƒãƒˆã•ã‚Œã‚‹
- [ ] `GET /api/auth/me` ã§ãƒ­ã‚°ã‚¤ãƒ³ä¸­ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ãŒè¿”ã‚‹
- [ ] ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒAPIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å«ã¾ã‚Œã¦ã„ãªã„ (`select` ã§é™¤å¤–)
- [ ] `POST /api/auth/logout` ã§CookieãŒå‰Šé™¤ã•ã‚Œã‚‹
- [ ] roadmap.md ã® Task 9 ã‚’ âœ… ã«æ›´æ–°ã—ãŸ

---

## Task 10: Streak CRUD APIã‚’å®Ÿè£…ã™ã‚‹

**ğŸ“¦ ãƒªãƒã‚¸ãƒˆãƒª**: `streak-buddy/backend/`
**â± ç›®å®‰**: 2ã€œ3æ™‚é–“

### ğŸ¯ ã“ã®èª²é¡Œã§å­¦ã¶ã“ã¨

- èªè¨¼ãŒå¿…è¦ãªAPIã®å®Ÿè£…
- RESTfulè¨­è¨ˆã®å®Ÿè·µ
- ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ (streak+1) ã®ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯

### ã‚„ã‚‹ã“ã¨ (Step by Step)

```
Step 1: routes/streaks.ts ã‚’èªè¨¼å¿…é ˆã«æ›´æ–°ã™ã‚‹

Step 2: ãƒ­ã‚°ã‚¤ãƒ³ä¸­ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¹ãƒˆãƒªãƒ¼ã‚¯ã ã‘æ“ä½œã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹

Step 3: ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ä½œã‚‹
  PATCH /api/streaks/:id/checkin
  â†’ currentStreakã‚’+1ã™ã‚‹
  â†’ é€£ç¶šãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹
  â†’ longestStreakã‚’æ›´æ–°ã™ã‚‹
  â†’ çµŒé¨“å€¤ã‚’ãƒšãƒƒãƒˆã«è¿½åŠ ã™ã‚‹
```

### å‚è€ƒã‚³ãƒ¼ãƒ‰

```typescript
// src/routes/streaks.ts (èªè¨¼å¿…é ˆç‰ˆ)
import { Router } from 'express';
import { prisma } from '../lib/prisma';
import { authMiddleware } from '../middleware/auth';

const router = Router();

// å…¨ãƒ«ãƒ¼ãƒˆã«èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’é©ç”¨
router.use(authMiddleware);

const getUserId = (req: any): string => req.userId;

// ä¸€è¦§å–å¾— (è‡ªåˆ†ã®ã‚¹ãƒˆãƒªãƒ¼ã‚¯ã ã‘)
router.get('/', async (req, res) => {
  const userId = getUserId(req);
  const streaks = await prisma.streak.findMany({
    where: { userId },
    orderBy: { createdAt: 'desc' },
  });
  res.json(streaks);
});

// æ–°è¦ä½œæˆ
router.post('/', async (req, res) => {
  const userId = getUserId(req);
  const { title, description } = req.body;
  const streak = await prisma.streak.create({
    data: { userId, title, description },
  });
  res.status(201).json(streak);
});

// ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ (ä»Šæ—¥ã®é”æˆã‚’è¨˜éŒ²ã™ã‚‹)
router.patch('/:id/checkin', async (req, res) => {
  const userId = getUserId(req);
  const streak = await prisma.streak.findFirst({
    where: { id: req.params.id, userId }, // ä»–äººã®ã¯æ“ä½œã•ã›ãªã„
  });
  if (!streak) return res.status(404).json({ error: 'Not found' });

  const today = new Date();
  today.setHours(0, 0, 0, 0);
  const lastChecked = streak.lastCheckedDate ? new Date(streak.lastCheckedDate) : null;
  if (lastChecked) lastChecked.setHours(0, 0, 0, 0);

  // ä»Šæ—¥ã™ã§ã«ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³æ¸ˆã¿ã‹ãƒã‚§ãƒƒã‚¯
  if (lastChecked && lastChecked.getTime() === today.getTime()) {
    return res.status(400).json({ error: 'ä»Šæ—¥ã¯ã™ã§ã«ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³æ¸ˆã¿ã§ã™' });
  }

  // æ˜¨æ—¥ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ã—ã¦ã„ã‚Œã°é€£ç¶š, ãã†ã§ãªã‘ã‚Œã°ãƒªã‚»ãƒƒãƒˆ
  const yesterday = new Date(today);
  yesterday.setDate(yesterday.getDate() - 1);
  const isContinuous = lastChecked && lastChecked.getTime() === yesterday.getTime();

  const newStreak = isContinuous ? streak.currentStreak + 1 : 1;
  const newLongest = Math.max(newStreak, streak.longestStreak);

  const updated = await prisma.streak.update({
    where: { id: streak.id },
    data: {
      currentStreak: newStreak,
      longestStreak: newLongest,
      lastCheckedDate: new Date(),
    },
  });

  // ãƒšãƒƒãƒˆã«çµŒé¨“å€¤ã‚’è¿½åŠ  (+10 EXP)
  await prisma.pet.updateMany({
    where: { userId },
    data: { experience: { increment: 10 } },
  });

  res.json({ streak: updated, message: `${newStreak}æ—¥é€£ç¶šé”æˆ!` });
});

// å‰Šé™¤
router.delete('/:id', async (req, res) => {
  const userId = getUserId(req);
  const streak = await prisma.streak.findFirst({
    where: { id: req.params.id, userId },
  });
  if (!streak) return res.status(404).json({ error: 'Not found' });
  await prisma.streak.delete({ where: { id: streak.id } });
  res.status(204).send(); // 204 = No Content (å‰Šé™¤æˆåŠŸ)
});

export default router;
```

### âœ… å®Œäº†ã®å®šç¾©

- [ ] èªè¨¼ãªã—ã§ `/api/streaks` ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ 401 ãŒè¿”ã‚‹
- [ ] ãƒ­ã‚°ã‚¤ãƒ³å¾Œã«è‡ªåˆ†ã®ã‚¹ãƒˆãƒªãƒ¼ã‚¯ã ã‘è¦‹ãˆã‚‹
- [ ] ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ã§ `currentStreak` ãŒå¢—ãˆã‚‹
- [ ] åŒã˜æ—¥ã«2å›ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹
- [ ] roadmap.md ã® Task 10 ã‚’ âœ… ã«æ›´æ–°ã—ãŸ

---

## Task 11: Zodãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å…¨APIã«è¿½åŠ ã™ã‚‹

**ğŸ“¦ ãƒªãƒã‚¸ãƒˆãƒª**: `streak-buddy/backend/` & `streak-buddy/frontend/`
**â± ç›®å®‰**: 2ã€œ3æ™‚é–“

### ğŸ¯ ã“ã®èª²é¡Œã§å­¦ã¶ã“ã¨

- Zodã«ã‚ˆã‚‹ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- TypeScriptã®å‹ã‚’Zodã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰è‡ªå‹•ç”Ÿæˆã™ã‚‹
- ãƒ•ãƒ­ãƒ³ãƒˆã¨ãƒãƒƒã‚¯ã§åŒã˜ã‚¹ã‚­ãƒ¼ãƒã‚’å…±æœ‰ã—ã¦å‹å®‰å…¨ã«ã™ã‚‹
- 422 Unprocessable Entity ã®é©åˆ‡ãªä½¿ã„æ–¹

### å‚è€ƒã‚³ãƒ¼ãƒ‰

```bash
# frontend ã¨ backend ä¸¡æ–¹ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install zod
```

```typescript
// shared/schemas.ts (ãƒ•ãƒ­ãƒ³ãƒˆã¨ãƒãƒƒã‚¯ä¸¡æ–¹ã§ä½¿ã†å‹å®šç¾©)
// ã¾ãŸã¯ backend/src/schemas.ts ã«ç½®ã„ã¦ frontendã‹ã‚‰importã™ã‚‹

import { z } from 'zod';

export const RegisterSchema = z.object({
  email: z.string().email('æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'),
  name: z.string().min(1, 'åå‰ã¯å¿…é ˆã§ã™').max(50, '50æ–‡å­—ä»¥å†…ã§å…¥åŠ›ã—ã¦ãã ã•ã„'),
  password: z.string().min(8, 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯8æ–‡å­—ä»¥ä¸ŠãŒå¿…è¦ã§ã™'),
});

export const LoginSchema = z.object({
  email: z.string().email(),
  password: z.string().min(1),
});

export const CreateStreakSchema = z.object({
  title: z.string().min(1, 'ã‚¿ã‚¤ãƒˆãƒ«ã¯å¿…é ˆã§ã™').max(100, '100æ–‡å­—ä»¥å†…ã§'),
  description: z.string().max(500, '500æ–‡å­—ä»¥å†…ã§').optional(),
});

// TypeScriptå‹ã‚’è‡ªå‹•ç”Ÿæˆ (äºŒé‡å®šç¾©ä¸è¦!)
export type RegisterInput = z.infer<typeof RegisterSchema>;
export type LoginInput = z.infer<typeof LoginSchema>;
export type CreateStreakInput = z.infer<typeof CreateStreakSchema>;
```

```typescript
// ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
router.post('/register', async (req, res) => {
  const result = RegisterSchema.safeParse(req.body);
  if (!result.success) {
    return res.status(422).json({
      error: 'ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼',
      details: result.error.issues.map(i => ({
        field: i.path[0],
        message: i.message,
      })),
    });
  }
  const { email, name, password } = result.data; // â† å‹å®‰å…¨ãªãƒ‡ãƒ¼ã‚¿
  // ... æ®‹ã‚Šã®å‡¦ç†
});
```

### âœ… å®Œäº†ã®å®šç¾©

- [ ] Zodã‚¹ã‚­ãƒ¼ãƒãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹
- [ ] å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒç©ºã®å ´åˆã« 422 ã‚¨ãƒ©ãƒ¼ãŒè¿”ã‚‹
- [ ] ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚ã‹ã‚Šã‚„ã™ã„
- [ ] ãƒ•ãƒ­ãƒ³ãƒˆã¨ãƒãƒƒã‚¯ã§åŒã˜ã‚¹ã‚­ãƒ¼ãƒã‚’ä½¿ã£ã¦ã„ã‚‹
- [ ] roadmap.md ã® Task 11 ã‚’ âœ… ã«æ›´æ–°ã—ãŸ

---

---

# Phase 3: ãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ã«ç¹‹ã’ã‚‹ (4é€±é–“)

---

## Task 12: Reactãƒ•ãƒ­ãƒ³ãƒˆã‹ã‚‰APIã‚’å‘¼ã³å‡ºã™

**ğŸ“¦ ãƒªãƒã‚¸ãƒˆãƒª**: `streak-buddy/frontend/`
**â± ç›®å®‰**: 3ã€œ4æ™‚é–“

### ğŸ¯ ã“ã®èª²é¡Œã§å­¦ã¶ã“ã¨

- å‹å®‰å…¨ãªAPIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ä½œã‚Šæ–¹
- async/awaitã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ãƒ‘ã‚¿ãƒ¼ãƒ³
- CORSè¨­å®šã®å®Ÿè·µ (ãƒ•ãƒ­ãƒ³ãƒˆã¨ãƒãƒƒã‚¯ãŒåˆ¥ãƒãƒ¼ãƒˆ)
- withCredentialsã§Cookieã‚’é€ã‚‹è¨­å®š

### å‚è€ƒã‚³ãƒ¼ãƒ‰

```typescript
// src/lib/api.ts (å‹å®‰å…¨ãªAPIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ)
const BASE_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';

async function request<T>(
  path: string,
  options?: RequestInit
): Promise<T> {
  const res = await fetch(`${BASE_URL}${path}`, {
    ...options,
    credentials: 'include', // â† Cookieã‚’è‡ªå‹•ã§é€ã‚‹ (èªè¨¼ã«å¿…é ˆ)
    headers: {
      'Content-Type': 'application/json',
      ...options?.headers,
    },
  });

  if (!res.ok) {
    const error = await res.json().catch(() => ({ error: 'Unknown error' }));
    throw new Error(error.error || `HTTP ${res.status}`);
  }

  // 204 No Content ã¯JSONãªã—
  if (res.status === 204) return undefined as T;

  return res.json() as Promise<T>;
}

// ä½¿ã„ã‚„ã™ã„ãƒ˜ãƒ«ãƒ‘ãƒ¼
export const api = {
  get: <T>(path: string) => request<T>(path),
  post: <T>(path: string, body: unknown) =>
    request<T>(path, { method: 'POST', body: JSON.stringify(body) }),
  patch: <T>(path: string, body?: unknown) =>
    request<T>(path, { method: 'PATCH', body: body ? JSON.stringify(body) : undefined }),
  delete: <T>(path: string) => request<T>(path, { method: 'DELETE' }),
};

// å„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®é–¢æ•° (å‹å®‰å…¨)
import type { Streak, User } from '../types';

export const authApi = {
  register: (data: RegisterInput) => api.post<{ userId: string }>('/api/auth/register', data),
  login: (data: LoginInput) => api.post<{ user: User }>('/api/auth/login', data),
  me: () => api.get<User>('/api/auth/me'),
  logout: () => api.post<void>('/api/auth/logout', {}),
};

export const streaksApi = {
  list: () => api.get<Streak[]>('/api/streaks'),
  create: (data: CreateStreakInput) => api.post<Streak>('/api/streaks', data),
  checkin: (id: string) => api.patch<{ streak: Streak; message: string }>(`/api/streaks/${id}/checkin`),
  delete: (id: string) => api.delete<void>(`/api/streaks/${id}`),
};
```

---

## Task 13: TanStack Queryã‚’å°å…¥ã™ã‚‹

**ğŸ“¦ ãƒªãƒã‚¸ãƒˆãƒª**: `streak-buddy/frontend/`
**â± ç›®å®‰**: 2ã€œ3æ™‚é–“

### ğŸ¯ ã“ã®èª²é¡Œã§å­¦ã¶ã“ã¨

- ãªãœuseStateã§APIãƒ‡ãƒ¼ã‚¿ã‚’ç®¡ç†ã™ã‚‹ã®ãŒè¾›ã„ã®ã‹
- TanStack Queryã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ä»•çµ„ã¿
- `useQuery` ã¨ `useMutation` ã®ä½¿ã„åˆ†ã‘
- æ¥½è¦³çš„UIæ›´æ–° (Optimistic Update) ã®æ¦‚å¿µ

### å‚è€ƒã‚³ãƒ¼ãƒ‰

```bash
npm install @tanstack/react-query
```

```typescript
// src/main.tsx
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';

const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      retry: 1,
      staleTime: 1000 * 60, // 1åˆ†é–“ã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½¿ã†
    },
  },
});

ReactDOM.createRoot(document.getElementById('root')!).render(
  <QueryClientProvider client={queryClient}>
    <App />
  </QueryClientProvider>
);
```

```typescript
// src/hooks/useStreaks.ts (TanStack Queryç‰ˆã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯)
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { streaksApi } from '../lib/api';

export function useStreaks() {
  return useQuery({
    queryKey: ['streaks'],
    queryFn: streaksApi.list,
  });
}

export function useCheckin() {
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: (id: string) => streaksApi.checkin(id),
    onSuccess: () => {
      // ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³æˆåŠŸå¾Œã«ãƒªã‚¹ãƒˆã‚’è‡ªå‹•æ›´æ–°
      queryClient.invalidateQueries({ queryKey: ['streaks'] });
      queryClient.invalidateQueries({ queryKey: ['pet'] });
    },
  });
}

export function useCreateStreak() {
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: streaksApi.create,
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['streaks'] });
    },
  });
}
```

```typescript
// ä½¿ã„æ–¹ (useStateã§æ›¸ã„ã¦ãŸã‚³ãƒ¼ãƒ‰ãŒã“ã‚“ãªã«ã‚·ãƒ³ãƒ—ãƒ«ã«ãªã‚‹)
function StreakList() {
  const { data: streaks, isLoading, error } = useStreaks();
  const checkin = useCheckin();

  if (isLoading) return <div>èª­ã¿è¾¼ã¿ä¸­...</div>;
  if (error) return <div>ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</div>;

  return (
    <ul>
      {streaks?.map(streak => (
        <li key={streak.id}>
          <span>{streak.title}</span>
          <span>ğŸ”¥ {streak.currentStreak}æ—¥</span>
          <button
            onClick={() => checkin.mutate(streak.id)}
            disabled={checkin.isPending}
          >
            ä»Šæ—¥ã®é”æˆã‚’è¨˜éŒ²
          </button>
        </li>
      ))}
    </ul>
  );
}
```

### âœ… å®Œäº†ã®å®šç¾©

- [ ] TanStack QueryãŒProviderã§è¨­å®šã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚¹ãƒˆãƒªãƒ¼ã‚¯ä¸€è¦§ãŒ `useQuery` ã§å–å¾—ã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ãŒ `useMutation` ã§å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³å¾Œã«ãƒªã‚¹ãƒˆãŒè‡ªå‹•æ›´æ–°ã•ã‚Œã‚‹
- [ ] roadmap.md ã® Task 13 ã‚’ âœ… ã«æ›´æ–°ã—ãŸ

---

## Task 14: ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã€œãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®èªè¨¼ãƒ•ãƒ­ãƒ¼ã‚’ä½œã‚‹

**ğŸ“¦ ãƒªãƒã‚¸ãƒˆãƒª**: `streak-buddy/frontend/`
**â± ç›®å®‰**: 3ã€œ4æ™‚é–“

### ğŸ¯ ã“ã®èª²é¡Œã§å­¦ã¶ã“ã¨

- èªè¨¼çŠ¶æ…‹ã‚’Contextã§ç®¡ç†ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³
- ä¿è­·ã•ã‚ŒãŸãƒ«ãƒ¼ãƒˆ (PrivateRoute) ã®å®Ÿè£…
- ãƒ­ã‚°ã‚¤ãƒ³ â†’ ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã®ãƒ•ãƒ­ãƒ¼

### å‚è€ƒã‚³ãƒ¼ãƒ‰

```typescript
// src/contexts/AuthContext.tsx
import { createContext, useContext } from 'react';
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { authApi } from '../lib/api';
import type { User, LoginInput, RegisterInput } from '../types';

type AuthContextType = {
  user: User | null | undefined;
  isLoading: boolean;
  login: (data: LoginInput) => Promise<void>;
  logout: () => Promise<void>;
  register: (data: RegisterInput) => Promise<void>;
};

const AuthContext = createContext<AuthContextType | null>(null);

export function AuthProvider({ children }: { children: React.ReactNode }) {
  const queryClient = useQueryClient();

  const { data: user, isLoading } = useQuery({
    queryKey: ['me'],
    queryFn: authApi.me,
    retry: false, // æœªãƒ­ã‚°ã‚¤ãƒ³ã¯å†è©¦è¡Œã—ãªã„
  });

  const loginMutation = useMutation({
    mutationFn: authApi.login,
    onSuccess: () => queryClient.invalidateQueries({ queryKey: ['me'] }),
  });

  const logoutMutation = useMutation({
    mutationFn: authApi.logout,
    onSuccess: () => queryClient.clear(), // å…¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢
  });

  return (
    <AuthContext.Provider value={{
      user,
      isLoading,
      login: async (data) => { await loginMutation.mutateAsync(data); },
      logout: async () => { await logoutMutation.mutateAsync(); },
      register: async (data) => { /* ... */ },
    }}>
      {children}
    </AuthContext.Provider>
  );
}

export const useAuth = () => {
  const ctx = useContext(AuthContext);
  if (!ctx) throw new Error('AuthProviderã®ä¸­ã§ä½¿ã£ã¦ãã ã•ã„');
  return ctx;
};
```

```typescript
// src/components/PrivateRoute.tsx
import { Navigate } from 'react-router-dom';
import { useAuth } from '../contexts/AuthContext';

export function PrivateRoute({ children }: { children: React.ReactNode }) {
  const { user, isLoading } = useAuth();

  if (isLoading) return <div>èª­ã¿è¾¼ã¿ä¸­...</div>;
  if (!user) return <Navigate to="/login" replace />;
  return <>{children}</>;
}
```

### âœ… å®Œäº†ã®å®šç¾©

- [ ] ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãªã„çŠ¶æ…‹ã§ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã«é£›ã¶
- [ ] ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸå¾Œã«ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«é·ç§»ã™ã‚‹
- [ ] ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚‚ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ãŒä¿ãŸã‚Œã‚‹ (CookieãŒæ®‹ã£ã¦ã„ã‚‹ãŸã‚)
- [ ] ãƒ­ã‚°ã‚¢ã‚¦ãƒˆå¾Œã«ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã«æˆ»ã‚‹
- [ ] roadmap.md ã® Task 14 ã‚’ âœ… ã«æ›´æ–°ã—ãŸ

---

## Task 15ã€œ19 (æ¦‚è¦)

> Task 15ã€œ19 ã¯å­¦ç¿’ã‚ˆã‚Šå®Ÿè£…æ¯”é‡ãŒé«˜ããªã‚Šã¾ã™ã€‚
> è©°ã¾ã£ãŸã‚‰Claude Codeã«ç›¸è«‡ã—ãªãŒã‚‰é€²ã‚ã¾ã—ã‚‡ã†ã€‚

| Task | å†…å®¹ | è¦ç‚¹ |
|---|---|---|
| 15 | Streak UIã®ä½œæˆ | ãƒ•ã‚©ãƒ¼ãƒ  + ä¸€è¦§ + ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ãƒœã‚¿ãƒ³ |
| 16 | ãƒšãƒƒãƒˆè‚²æˆã‚·ã‚¹ãƒ†ãƒ  | EXPè¨ˆç®—ã€ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã€ã‚¢ã‚¤ãƒ†ãƒ ä»˜ä¸ã®ãƒ­ã‚¸ãƒƒã‚¯ |
| 17 | Supabaseç§»è¡Œ | SQLite â†’ Supabase PostgreSQL + Supabase Auth |
| 18 | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤ | Railway or Render ã« Express ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ |
| 19 | ãƒ•ãƒ­ãƒ³ãƒˆãƒ‡ãƒ—ãƒ­ã‚¤ + ãƒªãƒ³ã‚¯è¿½åŠ  | Vercel + ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã«Streak Buddyã‚«ãƒ¼ãƒ‰ã‚’è¿½åŠ  |

---

---

# Phase 4: Next.js + ç£¨ã (1ãƒ¶æœˆ)

---

## Task 20: Next.js App Routerã‚’å­¦ã¶

**ğŸ“¦ ãƒªãƒã‚¸ãƒˆãƒª**: `streak-buddy` (Next.jsç‰ˆã«ç§»è¡Œ)
**â± ç›®å®‰**: 1é€±é–“

### ğŸ¯ ã“ã®èª²é¡Œã§å­¦ã¶ã“ã¨

- Next.jsã¨Reactã®é•ã„
- Server Components ã¨ Client Components ã®ä½¿ã„åˆ†ã‘
- App Router ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
- SSRã¨SSGã®é•ã„

### ã‚„ã‚‹ã“ã¨

```
Step 1: Next.jsã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’å®Œèµ°ã™ã‚‹
  https://nextjs.org/learn (å…¬å¼ã€ç„¡æ–™)
  â†’ App Routerç‰ˆã‚’é¸ã¶

Step 2: ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§ä½œã£ãŸã‚‚ã®ã‚’è¦‹ãªãŒã‚‰ã€
  Streak Buddyã®ãƒ•ãƒ­ãƒ³ãƒˆã‚’Next.jsã§æ›¸ãç›´ã—ã¦ã¿ã‚‹

Step 3: Server Componentsã‹ã‚‰Supabaseã‚’ç›´æ¥å‘¼ã¶ä½“é¨“ã‚’ã™ã‚‹
```

### å‚è€ƒã‚³ãƒ¼ãƒ‰

```typescript
// Next.js App Router ã§ã®åŸºæœ¬æ§‹é€ 
// app/
//   layout.tsx        â†’ å…¨ãƒšãƒ¼ã‚¸å…±é€šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
//   page.tsx          â†’ ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ (/)
//   dashboard/
//     page.tsx        â†’ /dashboard
//   streaks/
//     page.tsx        â†’ /streaks
//     [id]/
//       page.tsx      â†’ /streaks/:id
//   api/
//     streaks/
//       route.ts      â†’ /api/streaks (APIãƒ«ãƒ¼ãƒˆ)

// Server Component (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ): DBã‚’ç›´æ¥å‘¼ã¹ã‚‹
// app/dashboard/page.tsx
import { createServerComponentClient } from '@supabase/auth-helpers-nextjs';
import { cookies } from 'next/headers';

export default async function DashboardPage() {
  const supabase = createServerComponentClient({ cookies });
  const { data: streaks } = await supabase.from('streaks').select('*');
  // â† ã‚µãƒ¼ãƒãƒ¼ã§å®Ÿè¡Œã•ã‚Œã‚‹ã®ã§APIã‚’çµŒç”±ã—ãªãã¦ã„ã„!

  return <StreakList streaks={streaks} />;
}

// Client Component: interactivityãŒå¿…è¦ãªã¨ã
// 'use client' ã‚’å…ˆé ­ã«æ›¸ã
'use client';
function StreakList({ streaks }: { streaks: Streak[] }) {
  const [selected, setSelected] = useState<string | null>(null);
  // ...
}
```

---

## Task 23: å‹å®‰å…¨ãªAPIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’å®Ÿè£…ã™ã‚‹

**ğŸ“¦ ãƒªãƒã‚¸ãƒˆãƒª**: `streak-buddy`
**â± ç›®å®‰**: 2ã€œ3æ™‚é–“

### ğŸ¯ ã“ã®èª²é¡Œã§å­¦ã¶ã“ã¨

- fetchã®`any`å‹å•é¡Œã‚’è§£æ±ºã™ã‚‹
- Zodã‚¹ã‚­ãƒ¼ãƒã¨TypeScriptå‹ã®çµ±åˆ
- å®Ÿè¡Œæ™‚ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®é‡è¦æ€§

### å‚è€ƒã‚³ãƒ¼ãƒ‰

```typescript
// Zodã‚¹ã‚­ãƒ¼ãƒã‚’ä½¿ã£ãŸå‹å®‰å…¨ãªfetch
import { z } from 'zod';

const StreakSchema = z.object({
  id: z.string(),
  title: z.string(),
  currentStreak: z.number(),
  longestStreak: z.number(),
  lastCheckedDate: z.string().nullable(),
});

const StreakArraySchema = z.array(StreakSchema);

// å‹å®‰å…¨ãªfetché–¢æ•°
async function safeFetch<T>(
  url: string,
  schema: z.ZodType<T>,
  options?: RequestInit
): Promise<T> {
  const res = await fetch(url, options);
  if (!res.ok) throw new Error(`HTTP ${res.status}`);
  const data = await res.json();
  return schema.parse(data); // â† ã‚¹ã‚­ãƒ¼ãƒã¨åˆã‚ãªã‘ã‚Œã°ã“ã“ã§ã‚¨ãƒ©ãƒ¼
}

// ä½¿ã„æ–¹
const streaks = await safeFetch('/api/streaks', StreakArraySchema);
// streaks ã¯ Streak[] å‹ (æ¨è«–ã•ã‚Œã‚‹)
```

---

## Task 24: ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚’æœ€çµ‚æ•´å‚™ã™ã‚‹

**ğŸ“¦ ãƒªãƒã‚¸ãƒˆãƒª**: `platypuscode-portfolio`
**â± ç›®å®‰**: 1ã€œ2æ™‚é–“

### ã‚„ã‚‹ã“ã¨

```
Step 1: Streak Buddy ã®å…¬é–‹URLãŒå–å¾—ã§ããŸã‚‰ã€
  ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã®ã€ŒWorksã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚«ãƒ¼ãƒ‰ã‚’è¿½åŠ ã™ã‚‹

Step 2: ã‚«ãƒ¼ãƒ‰ã«å«ã‚ã‚‹æƒ…å ±:
  - ã‚¢ãƒ—ãƒªã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
  - ã‚¿ã‚¤ãƒˆãƒ«: Streak Buddy
  - èª¬æ˜: ç¿’æ…£ç¶™ç¶š Ã— ãƒãƒ¼ãƒãƒ£ãƒ«ãƒšãƒƒãƒˆè‚²æˆã‚¢ãƒ—ãƒª
  - ä½¿ç”¨æŠ€è¡“: React, TypeScript, Node.js, PostgreSQL, Prisma, JWTèªè¨¼
  - ãƒªãƒ³ã‚¯: GitHubã¨ãƒ©ã‚¤ãƒ–ãƒ‡ãƒ¢ã®URL

Step 3: READMEã‚’æ›´æ–°ã—ã¦é–‹ç™ºçµŒç·¯ã‚‚æ›¸ã
```

---

---

# ğŸ“Œ ä½¿ã„æ–¹ã®ãƒ’ãƒ³ãƒˆ

```
1. ã‚¿ã‚¹ã‚¯ã‚’1ã¤ãšã¤é€²ã‚ã‚‹
   â†’ å…¨éƒ¨ä¸€åº¦ã«ã‚„ã‚ã†ã¨ã—ãªã„ã€‚1ã‚¿ã‚¹ã‚¯å®Œäº†ã—ãŸã‚‰ä¼‘æ†©

2. è©°ã¾ã£ãŸã‚‰ Claude Code ã«ä¸¸æŠ•ã’ã—ãªã„
   â†’ ã¾ãšè‡ªåˆ†ã§10åˆ†è€ƒãˆã‚‹ â†’ ã‚ã‹ã‚‰ãªã‘ã‚Œã°ã€Œä½•ãŒã‚ã‹ã‚‰ãªã„ã‹ã€ã‚’è¨€èªåŒ–ã—ã¦èã

3. å‹•ã„ãŸã‚‰ã‚³ãƒŸãƒƒãƒˆã™ã‚‹ç™–ã‚’ã¤ã‘ã‚‹
   â†’ å°ã•ã„å˜ä½ã§ã‚³ãƒŸãƒƒãƒˆã™ã‚‹ã“ã¨ã§ã€å£Šã‚Œã¦ã‚‚ã™ãæˆ»ã‚Œã‚‹

4. roadmap.md ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’æ›´æ–°ã™ã‚‹ç¿’æ…£ã‚’ã¤ã‘ã‚‹
   â†’ é€²æ—ã®å¯è¦–åŒ–ãŒãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã«ãªã‚‹
```

---

*Last updated: 2026-02-22*
